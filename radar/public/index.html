<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sommerfeld.io Tech Radar</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #111317;
            color: rgba(226, 228, 233, 0.82);
        }

        .header {
            background: #111317;
            color: rgba(226, 228, 233, 0.82);
            padding: 2rem;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .header .version {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-top: 0.5rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .legend-section {
            background: #1E2129;
            padding: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .legend-section h3 {
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
            color: rgb(255, 110, 66);
        }

        .legend-item {
            display: flex;
            align-items: flex-start;
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }

        .legend-item .color-box {
            width: 20px;
            height: 20px;
            margin-right: 0.5rem;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .legend-description {
            font-size: 0.85rem;
            color: rgba(226, 228, 233, 0.6);
            margin-top: 0.25rem;
        }

        .legend-item-content {
            display: flex;
            flex-direction: column;
        }

        #radar-container {
            background: #1E2129;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 2rem;
            min-height: 600px;
        }

        #radar-canvas {
            max-width: 100%;
            height: auto;
        }

        .technologies {
            background: #1E2129;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .technologies h2 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: rgb(255, 110, 66);
        }

        .technology-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
        }

        .technology-card {
            background: #1E2129;
            padding: 1rem;
            border-left: 4px solid;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .technology-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .technology-card.highlighted {
            box-shadow: 0 0 0 3px rgb(255, 110, 66);
        }

        .technology-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .technology-number {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
            margin-right: 0.75rem;
            flex-shrink: 0;
        }

        .technology-name {
            font-weight: 600;
            font-size: 1rem;
            flex-grow: 1;
            color: rgba(226, 228, 233, 0.95);
        }

        .technology-meta {
            font-size: 0.85rem;
            color: rgba(226, 228, 233, 0.6);
            margin-left: 2.25rem;
        }

        .technology-movement {
            display: inline-block;
            margin-left: 0.5rem;
            font-size: 1.1rem;
        }

        .moved-in {
            color: #4ade80;
        }

        .moved-out {
            color: #f87171;
        }

        .new {
            color: #facc15;
        }

        .footer {
            text-align: center;
            padding: 2rem;
            font-size: 0.9rem;
            color: rgba(226, 228, 233, 0.6);
        }

        .footer a {
            color: rgb(255, 110, 66);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer a:hover {
            color: rgb(255, 110, 66);
            text-decoration: underline;
        }

        .github-icon {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        .tooltip {
            position: absolute;
            background: #1E2129;
            color: rgba(226, 228, 233, 0.95);
            padding: 0.5rem 0.75rem;
            font-size: 0.9rem;
            font-weight: 500;
            pointer-events: none;
            z-index: 1000;
            white-space: nowrap;
            box-shadow: 0 2px 8px rgba(0,0,0,0.4);
            border: 1px solid rgba(255, 110, 66, 0.3);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .technology-grid {
                grid-template-columns: 1fr;
            }

            .legend {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Sommerfeld.io Tech Radar</h1>
        <p>This is the technology radar for the sommerfeld.io GitHub organization. It provides an overview of technologies, tools, frameworks, and practices we use, assess, or have on our radar for future consideration.</p>
        <div class="version">Version <span id="radar-version">1.0.0</span></div>
    </div>

    <div class="container">
        <div class="legend">
            <div class="legend-section">
                <h3>Rings</h3>
                <div id="rings-legend"></div>
            </div>
            <div class="legend-section">
                <h3>Quadrants</h3>
                <div id="quadrants-legend"></div>
            </div>
        </div>

        <div id="radar-container">
            <canvas id="radar-canvas" width="800" height="800"></canvas>
        </div>

        <div class="technologies">
            <h2>All Technologies</h2>
            <div class="technology-grid" id="technology-list"></div>
        </div>
    </div>

    <div class="footer">
        <div>Copyright © sommerfeld.io</div>
        <a href="https://github.com/sommerfeld-io" target="_blank" rel="noopener noreferrer">
            <svg class="github-icon" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
            </svg>
            Sommerfeld.io on GitHub
        </a>
    </div>

    <script>
        const movementSymbols = {
            'in': '▲',
            'out': '▼',
            'new': '★',
            'none': '⬤'
        };

        function getMovementClass(movement) {
            if (movement === 'in') return 'moved-in';
            if (movement === 'out') return 'moved-out';
            if (movement === 'new') return 'new';
            return '';
        }

        function getMovementSymbol(movement) {
            return movementSymbols[movement] || movementSymbols.none;
        }

        let radarData = null;
        let hoveredTech = null;
        let tooltip = null;

        fetch('radar-data.json')
            .then(response => response.json())
            .then(data => {
                radarData = data;
                document.getElementById('radar-version').textContent = data.version;
                renderLegend(data);
                renderRadar(data);
                renderTechnologies(data);
            })
            .catch(error => console.error('Error loading radar data:', error));

        function renderLegend(data) {
            const ringsLegend = document.getElementById('rings-legend');
            const quadrantsLegend = document.getElementById('quadrants-legend');

            data.rings.forEach(ring => {
                const item = document.createElement('div');
                item.className = 'legend-item';
                item.innerHTML = `
                    <div class="color-box" style="background-color: ${ring.color}"></div>
                    <div class="legend-item-content">
                        <div><strong>${ring.name}</strong></div>
                        <div class="legend-description">${ring.description}</div>
                    </div>
                `;
                ringsLegend.appendChild(item);
            });

            data.quadrants.forEach(quadrant => {
                const item = document.createElement('div');
                item.className = 'legend-item';
                item.innerHTML = `
                    <div class="color-box" style="background-color: ${quadrant.color}"></div>
                    <div class="legend-item-content">
                        <div><strong>${quadrant.name}</strong></div>
                        <div class="legend-description">${quadrant.description || ''}</div>
                    </div>
                `;
                quadrantsLegend.appendChild(item);
            });
        }

        function renderRadar(data) {
            const canvas = document.getElementById('radar-canvas');
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const maxRadius = Math.min(centerX, centerY) - 50;

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw rings with gradient (blue outside to green inside)
            const ringCount = data.rings.length;
            for (let i = ringCount - 1; i >= 0; i--) {
                const ring = data.rings[i];
                const radius = maxRadius * ((i + 1) / ringCount);
                
                const gradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, radius);
                
                // Outer ring is more blue, inner rings become more green
                const blueRatio = i / (ringCount - 1);
                const greenRatio = 1 - blueRatio;
                
                const r = Math.round(50 * blueRatio + 100 * greenRatio);
                const g = Math.round(150 * blueRatio + 200 * greenRatio);
                const b = Math.round(200 * blueRatio + 100 * greenRatio);
                
                gradient.addColorStop(0, `rgba(${r + 20}, ${g + 20}, ${b + 20}, 0.3)`);
                gradient.addColorStop(1, `rgba(${r}, ${g}, ${b}, 0.3)`);
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                ctx.fill();

                ctx.strokeStyle = 'rgba(226, 228, 233, 0.2)';
                ctx.lineWidth = 1;
                ctx.stroke();

                // Ring label
                ctx.fillStyle = 'rgba(226, 228, 233, 0.6)';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(ring.name, centerX, centerY - radius + 15);
            }

            // Draw quadrant lines
            ctx.strokeStyle = 'rgba(226, 228, 233, 0.3)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY - maxRadius);
            ctx.lineTo(centerX, centerY + maxRadius);
            ctx.moveTo(centerX - maxRadius, centerY);
            ctx.lineTo(centerX + maxRadius, centerY);
            ctx.stroke();

            // Draw quadrant labels
            const quadrantPositions = [
                { x: centerX + maxRadius * 0.7, y: centerY - maxRadius * 0.7 }, // Top right
                { x: centerX + maxRadius * 0.7, y: centerY + maxRadius * 0.7 }, // Bottom right
                { x: centerX - maxRadius * 0.7, y: centerY + maxRadius * 0.7 }, // Bottom left
                { x: centerX - maxRadius * 0.7, y: centerY - maxRadius * 0.7 }  // Top left
            ];

            data.quadrants.forEach((quadrant, index) => {
                const pos = quadrantPositions[index];
                ctx.fillStyle = quadrant.color;
                ctx.font = 'bold 14px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(quadrant.name, pos.x, pos.y);
            });

            // Draw technologies
            data.technologies.forEach((tech, index) => {
                const quadrant = data.quadrants.find(q => q.name === tech.quadrant);
                const ring = data.rings.find(r => r.name === tech.ring);
                if (!quadrant || !ring) return;

                const ringIndex = data.rings.indexOf(ring);
                const quadrantIndex = data.quadrants.indexOf(quadrant);

                const innerRadius = maxRadius * (ringIndex / ringCount);
                const outerRadius = maxRadius * ((ringIndex + 1) / ringCount);
                const radius = (innerRadius + outerRadius) / 2;

                const angleOffset = (Math.PI / 2) * quadrantIndex;
                const angleRange = Math.PI / 2;
                const angle = angleOffset + (Math.random() * angleRange * 0.6 + angleRange * 0.2);

                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);

                tech._x = x;
                tech._y = y;
                tech._radius = 15;

                // Draw blip
                ctx.fillStyle = quadrant.color;
                ctx.beginPath();
                ctx.arc(x, y, tech._radius, 0, 2 * Math.PI);
                ctx.fill();

                // Draw number
                ctx.fillStyle = 'white';
                ctx.font = 'bold 12px sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(index + 1, x, y);

                // Draw movement indicator
                const movement = tech.moved || 'none';
                const symbol = getMovementSymbol(movement);
                if (symbol !== '⬤') {
                    ctx.font = 'bold 14px sans-serif';
                    if (movement === 'in') {
                        ctx.fillStyle = '#4ade80';
                        ctx.fillText(symbol, x, y - 22);
                    } else if (movement === 'out') {
                        ctx.fillStyle = '#f87171';
                        ctx.fillText(symbol, x, y + 22);
                    } else if (movement === 'new') {
                        ctx.fillStyle = '#facc15';
                        ctx.fillText(symbol, x - 20, y - 5);
                    }
                }
            });

            // Add canvas hover and click handlers
            canvas.addEventListener('mousemove', (e) => handleCanvasHover(e, canvas, data));
            canvas.addEventListener('mouseleave', () => {
                removeTooltip();
                unhighlightAllCards();
            });
            canvas.addEventListener('click', (e) => handleCanvasClick(e, canvas, data));
        }

        function handleCanvasHover(e, canvas, data) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            const x = (e.clientX - rect.left) * scaleX;
            const y = (e.clientY - rect.top) * scaleY;

            let found = false;
            data.technologies.forEach((tech, index) => {
                const dx = x - tech._x;
                const dy = y - tech._y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < tech._radius) {
                    found = true;
                    showTooltip(tech.name, e.clientX, e.clientY);
                    highlightCard(index);
                    canvas.style.cursor = 'pointer';
                }
            });

            if (!found) {
                removeTooltip();
                unhighlightAllCards();
                canvas.style.cursor = 'default';
            }
        }

        function handleCanvasClick(e, canvas, data) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            const x = (e.clientX - rect.left) * scaleX;
            const y = (e.clientY - rect.top) * scaleY;

            data.technologies.forEach((tech, index) => {
                const dx = x - tech._x;
                const dy = y - tech._y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < tech._radius) {
                    const card = document.querySelector(`[data-tech-index="${index}"]`);
                    if (card) {
                        card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        card.classList.add('highlighted');
                        setTimeout(() => card.classList.remove('highlighted'), 2000);
                    }
                }
            });
        }

        function showTooltip(text, x, y) {
            removeTooltip();
            tooltip = document.createElement('div');
            tooltip.className = 'tooltip';
            tooltip.textContent = text;
            tooltip.style.left = (x + 10) + 'px';
            tooltip.style.top = (y - 30) + 'px';
            document.body.appendChild(tooltip);
        }

        function removeTooltip() {
            if (tooltip) {
                tooltip.remove();
                tooltip = null;
            }
        }

        function highlightCard(index) {
            unhighlightAllCards();
            const card = document.querySelector(`[data-tech-index="${index}"]`);
            if (card) {
                card.classList.add('highlighted');
            }
        }

        function unhighlightAllCards() {
            document.querySelectorAll('.technology-card.highlighted').forEach(card => {
                card.classList.remove('highlighted');
            });
        }

        function renderTechnologies(data) {
            const list = document.getElementById('technology-list');
            
            // Sort by number (index)
            const sortedTechs = [...data.technologies].map((tech, index) => ({
                ...tech,
                index: index + 1
            }));

            sortedTechs.forEach((tech) => {
                const quadrant = data.quadrants.find(q => q.name === tech.quadrant);
                const card = document.createElement('div');
                card.className = 'technology-card';
                card.style.borderLeftColor = quadrant.color;
                card.setAttribute('data-tech-index', tech.index - 1);

                const movement = tech.moved || 'none';
                const movementClass = getMovementClass(movement);
                const movementSymbol = getMovementSymbol(movement);
                const movementHTML = movementSymbol !== '⬤' ? 
                    `<span class="technology-movement ${movementClass}">${movementSymbol}</span>` : '';

                card.innerHTML = `
                    <div class="technology-header">
                        <div class="technology-number" style="background-color: ${quadrant.color}">${tech.index}</div>
                        <div class="technology-name">${tech.name}${movementHTML}</div>
                    </div>
                    <div class="technology-meta">${tech.quadrant} • ${tech.ring}</div>
                `;

                card.addEventListener('mouseenter', () => {
                    const canvas = document.getElementById('radar-canvas');
                    const radarTech = data.technologies[tech.index - 1];
                    if (radarTech && radarTech._x && radarTech._y) {
                        const rect = canvas.getBoundingClientRect();
                        showTooltip(tech.name, rect.left + radarTech._x * rect.width / canvas.width, 
                                              rect.top + radarTech._y * rect.height / canvas.height);
                    }
                });

                card.addEventListener('mouseleave', () => {
                    removeTooltip();
                });

                list.appendChild(card);
            });
        }
    </script>
</body>
</html>
